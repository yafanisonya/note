(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{399:function(t,a,s){"use strict";s.r(a);var n=s(42),i=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"jquery懒加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jquery懒加载"}},[t._v("#")]),t._v(" jQuery懒加载")]),t._v(" "),s("blockquote",[s("p",[t._v("在网页中，常常需要用到图片，而图片需要消耗较大的流量。正常情况下，浏览器会解析整个HTML代码，然后从上到下依次加载"),s("img",{attrs:{src:"xxx"}}),t._v("的图片标签。如果页面很长，隐藏在页面下方的图片其实已经被浏览器加载了。如果用户不向下滚动页面，就没有看到这些图片，相当于白白浪费了图片的流量。")])]),t._v(" "),s("blockquote",[s("p",[t._v("懒加载即用户滚动页面时显示出来的时候才加载图片。当网速非常快的时候，用户并不能感知懒加载的动作，既省流量又不影响用户浏览。")])]),t._v(" "),s("h3",{attrs:{id:"原理："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原理："}},[t._v("#")]),t._v(" 原理：")]),t._v(" "),s("p",[t._v('在输出HTML的时候，不要直接输出<img src="xxx"，而是输出如下img标签：\n'),s("code",[t._v('<img src="/static/loading.gif" data-src="http://真正的图片地址/xxx.jpg">')]),t._v("\n因此，页面显示的图片是一个gif加载动画。当页面滚动时，如果图片出现在屏幕中，就利用jQuery把"),s("img"),t._v("的src属性替换为data-src的内容，浏览器就会实时加载。")]),t._v(" "),s("h2",{attrs:{id:"_1-判断元素出现在视野中"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-判断元素出现在视野中"}},[t._v("#")]),t._v(" 1.判断元素出现在视野中")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/16155751-bbf50761ad17f753.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"height"}}),t._v("\n红色区域为当前窗口，绿色区域代表整个页面，横线代表一行文字")]),t._v(" "),s("blockquote",[s("p",[t._v("从上图中可以看出，如果\n"),s("code",[t._v("$(node).offset().top <= $(window).height() + $(window).scrolltop()")]),t._v("\n那么文字出现在用户视野")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("function isShow($node){\n  return $node.offset().top <= $(window).height() + $(window).scrollTop()\n}\n")])])]),s("h2",{attrs:{id:"_2-加载图片"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-加载图片"}},[t._v("#")]),t._v(" 2.加载图片")]),t._v(" "),s("blockquote",[s("p",[t._v("使用jQuery将src地址替换为data-src地址")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(' <img src="https://yafanisonya.github.io/resume/houseofcards/img/loading.gif" alt="" data-src="http://cdn.jirengu.com/book.jirengu.com/img/1.jpg">\n <img src="https://yafanisonya.github.io/resume/houseofcards/img/loading.gif" alt="" data-src="http://cdn.jirengu.com/book.jirengu.com/img/2.jpg">\n <img src="https://yafanisonya.github.io/resume/houseofcards/img/loading.gif" alt="" data-src="http://cdn.jirengu.com/book.jirengu.com/img/3.jpg">\n <img src="https://yafanisonya.github.io/resume/houseofcards/img/loading.gif" alt="" data-src="http://cdn.jirengu.com/book.jirengu.com/img/4.jpg">\n')])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("function loadImg($img){\n      $img.attr('src', $img.attr('data-src')) // 设置src属性\n      $img.attr('data-isLoaded', 1)  //已加载过的图片做标记\n      //当用户在滚动时判断图片是否已经加载，若加载过，就不在加载\n }\n")])])]),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/16155751-fce1a37bf738dfe9.gif?imageMogr2/auto-orient/strip",alt:"lazyLoad"}})]),t._v(" "),s("h3",{attrs:{id:"js代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js代码"}},[t._v("#")]),t._v(" js代码")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("   //用户一开始进来的时候就进行一次是否出现在可视窗口的判断\n    start()\n    //滚动页面再进行判断\n    $(window).on('scroll', function(){\n      start()\n    })\n    \n    function start(){\n      //.not('[data-isLoaded]')选中已加载的图片不需要重新加载\n      $('.container img').not('[data-isLoaded]').each(function(){\n        var $node = $(this)\n        if( isShow($node) ){\n          loadImg($node)\n        }\n      })\n    }\n    \n    //判断一个元素是否出现在可视窗口\n    function isShow($node){\n      return $node.offset().top <= $(window).height() + $(window).scrollTop()\n    }\n    //加载图片\n    function loadImg($img){\n      $img.attr('src', $img.attr('data-src'))\n      $img.attr('data-isLoaded', 1)\n    }\n\n<\/script>\n")])])])])}),[],!1,null,null,null);a.default=i.exports}}]);